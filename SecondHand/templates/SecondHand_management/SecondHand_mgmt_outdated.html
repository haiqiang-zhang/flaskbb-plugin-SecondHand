{#{% set page_title = title %}#}
{#{% set active = "SecondHand_bp.SecondHand_mgmt" %}#}
{% set page_title = "二手交易管理 - 交易超时" %}
{% set active = "SecondHand_management_bp.outdated_transaction" %}


{% extends theme("management/management_layout.html") %}

{% block breadcrumb %}
    <ol class="breadcrumb flaskbb-breadcrumb">
        <li class="breadcrumb-item"><a href="{{ url_for('forum.index') }}">{% trans %}Forum{% endtrans %}</a></li>
        <li class="breadcrumb-item"><a href="{{ url_for('management.overview') }}">{% trans %}
            Management{% endtrans %}</a></li>
        <li class="breadcrumb-item active">二手交易管理</li>
    </ol>
{% endblock %}

{% block management_content %}
    {%- from theme('_macros/pagination.html') import render_pagination -%}
    {%- from theme('_macros/navigation.html') import navlink with context -%}
    {%- from theme('_macros/form.html') import render_field -%}

    <div class="col-md-3 settings-col">
        <div class="nav-sidebar">
            <ul class="nav">
                {{ navlink('SecondHand_management_bp.outdated_transaction', "交易超时") }}
                {{ navlink('SecondHand_management_bp.outdated_transaction', "正在交易") }}
                {{ navlink('SecondHand_management_bp.outdated_transaction', "已发布") }}
                {{ navlink('SecondHand_management_bp.outdated_transaction', "交易完成") }}
            </ul>
        </div>
    </div>


    <div class="col-md-9 settings-col with-left-border">
        <div class="card settings">
            <div class="card-header settings-header">
                <span class="fas fa-hand-holding-usd"></span>交易超时
            </div>
            <div class="card-body settings-body">
                {% for user in users.items %}
                    <div class="row settings-row hover">
                        <div class="col-md-1 col-sm-1 col-1"><input type="checkbox" name="rowid" class="action-checkbox"
                                                                    value="{{ user.id }}" title="Select User"/></div>
                        <div class="col-md-2 col-sm-2 col-3"><a href="{{ user.url }}">{{ user.username }}</a></div>
                        <div class="col-md-2 col-sm-2 col-3">{{ user.post_count }}</div>
                        <div class="col-md-3 col-sm-3 d-none d-sm-block">{{ user.date_joined|format_date }}</div>
                        <div class="col-md-2 col-sm-2 col-3">{{ user.primary_group.name }}</div>
                        <div class="col-2">
                            {% if current_user|can_edit_user and not user|is_admin or current_user|is_admin %}
                                <a href="{{ url_for('management.edit_user', user_id = user.id) }}" class="btn btn-icon">
                                    <span class="fas fa-edit text-primary" data-bs-toggle="tooltip"
                                          title="{% trans %}Edit{% endtrans %}"></span>
                                </a>
                            {% endif %}

                            {% if current_user|can_ban_user and not user.permissions['banned'] %}
                                {{ action_confirm(
                                id="ban-" ~ user.id,
                                url=url_for('management.ban_user', user_id=user.id),
                                title=_("Ban"),
                                icon="fas fa-flag text-warning"
                            ) }}
                            {% endif %}

                            {% if current_user|can_ban_user and user.permissions['banned'] %}
                                {{ action_confirm(
                                id="ban-" ~ user.id,
                                url=url_for('management.unban_user', user_id=user.id),
                                title=_("Unban"),
                                icon="fas fa-flag text-success"
                            ) }}
                            {% endif %}

                            {% if current_user|is_admin %}
                                {{ action_confirm(
                                id="delete-" ~ user.id,
                                url=url_for('management.delete_user', user_id=user.id),
                                title=_("Delete"),
                                icon="far fa-trash-alt text-danger"
                            ) }}
                            {% endif %}
                        </div>
                    </div>
                {% else %}
                    <div class="row settings-row">
                        <div class="col-12">没有交易超时的订单</div>
                    </div>
                {% endfor %}

            </div>
        </div>
    </div>
{% endblock %}
